<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>anyGem - Super Agent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
    <style>
        body { background-color: #131314; color: #e3e3e3; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        
        .prose pre { background-color: #1e1e20; border-radius: 8px; padding: 1rem; overflow-x: auto; border: 1px solid #333; }
        .prose code { color: #f87171; background-color: rgba(255,255,255,0.1); padding: 0.15rem 0.3rem; border-radius: 4px; font-size: 0.9em; }
        .prose a { color: #8ab4f8; text-decoration: underline; text-underline-offset: 4px; }
        .prose ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1rem; }
        .prose h1, .prose h2, .prose h3 { color: #fff; margin-top: 1.5rem; margin-bottom: 0.5rem; font-weight: 600; }
        
        .typing-indicator span { animation: blink 1.4s infinite both; height: 6px; width: 6px; background-color: #aaa; border-radius: 50%; display: inline-block; margin: 0 2px; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes blink { 0% { opacity: 0.2; } 20% { opacity: 1; } 100% { opacity: 0.2; } }
    </style>
</head>
<body class="h-screen flex overflow-hidden font-sans antialiased">

    <div id="preview-modal" class="fixed inset-0 z-50 hidden bg-black/80 backdrop-blur-sm flex-col">
        <div class="h-12 bg-[#1e1f22] border-b border-[#333] flex items-center justify-between px-4 flex-shrink-0">
            <div class="flex items-center gap-2 text-gray-300">
                <span class="material-symbols-rounded text-blue-400">terminal</span>
                <span class="font-medium text-sm font-mono">anyGem Artifact Viewer</span>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="refreshPreview()" class="text-gray-400 hover:text-white transition-colors" title="é‡æ–°æ•´ç†">
                    <span class="material-symbols-rounded text-[20px]">refresh</span>
                </button>
                <button onclick="closePreview()" class="text-gray-400 hover:text-red-400 transition-colors bg-[#333] hover:bg-red-500/20 rounded-full p-1" title="é—œé–‰">
                    <span class="material-symbols-rounded text-[20px]">close</span>
                </button>
            </div>
        </div>
        <div class="flex-1 bg-white relative w-full h-full">
            <iframe id="preview-iframe" sandbox="allow-scripts allow-forms allow-modals" class="w-full h-full border-none absolute inset-0"></iframe>
        </div>
    </div>

    <aside id="sidebar" class="w-72 bg-[#1e1f22] border-r border-[#333] flex flex-col transition-all duration-300 z-20 absolute md:relative h-full -translate-x-full md:translate-x-0">
        <div class="p-4 flex items-center justify-between">
            <h1 class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">anyGem Agent</h1>
            <button onclick="toggleSidebar()" class="md:hidden text-gray-400 hover:text-white"><span class="material-symbols-rounded">close</span></button>
        </div>
        <div class="px-4 pb-2">
            <button onclick="startNewSession()" class="w-full flex items-center justify-center gap-2 bg-[#2a2b2f] hover:bg-[#33353a] text-sm font-medium py-2.5 rounded-full transition-colors border border-[#444]">
                <span class="material-symbols-rounded text-lg">add</span> æ–°å°è©±
            </button>
        </div>
        <div id="session-list" class="flex-1 overflow-y-auto p-2 space-y-1 mt-2">
            </div>
    </aside>

    <main class="flex-1 flex flex-col relative h-full w-full">
        <header class="h-14 flex items-center justify-between px-4 md:hidden border-b border-[#333] bg-[#131314] z-10">
            <button onclick="toggleSidebar()" class="text-gray-400 hover:text-white"><span class="material-symbols-rounded">menu</span></button>
            <span class="font-medium text-gray-200" id="mobile-title">æ–°å°è©±</span>
            <div class="w-6"></div> 
        </header>

        <div id="chat-container" class="flex-1 overflow-y-auto p-4 md:p-8 space-y-6 pb-48 md:pb-56 scroll-smooth">
            <div class="flex gap-4 max-w-4xl mx-auto mt-10">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0 shadow-lg shadow-purple-900/20">
                    <span class="material-symbols-rounded text-white">auto_awesome</span>
                </div>
                <div class="flex-1 pt-2">
                    <h2 class="text-2xl font-semibold mb-2 text-white">æ‚¨å¥½ï¼æˆ‘æ˜¯ anyGem ä»£ç†äººã€‚</h2>
                    <p class="text-gray-400 mb-4">æˆ‘å¯ä»¥å¹«æ‚¨å»ºç«‹æ–‡ä»¶ã€è¦åŠƒè¡Œäº‹æ›†ã€è®€å–è³‡æ–™åº«ï¼Œç”šè‡³è§£æ PDF å ±å‘Šèˆ‡ç›´æ¥æ¸²æŸ“ç¶²é æ‡‰ç”¨ç¨‹å¼ã€‚è«‹å•ä»Šå¤©éœ€è¦ä»€éº¼å”åŠ©ï¼Ÿ</p>
                </div>
            </div>
        </div>

        <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-[#131314] via-[#131314] to-transparent pt-10 pb-6 px-4 md:px-8">
            <div class="max-w-4xl mx-auto relative bg-[#1e1f22] rounded-2xl border border-[#333] shadow-xl focus-within:border-blue-500 transition-colors">
                
                <div id="upload-preview-container" class="hidden px-4 pt-3 flex gap-2 overflow-x-auto items-center">
                    <div class="relative group flex items-center gap-2">
                        <img id="image-preview" src="" class="hidden h-16 w-16 object-cover rounded-lg border border-[#444]">
                        
                        <div id="doc-preview" class="hidden flex items-center gap-2 bg-[#2a2b2f] px-3 py-2 rounded-lg border border-[#444]">
                            <span class="material-symbols-rounded text-blue-400">description</span>
                            <span id="doc-filename" class="text-sm text-gray-200 font-medium max-w-[150px] truncate"></span>
                        </div>

                        <button onclick="clearUpload()" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10">
                            <span class="material-symbols-rounded text-sm">close</span>
                        </button>
                    </div>
                </div>

                <div class="flex items-end p-2 md:p-3 gap-2">
                    <button onclick="document.getElementById('file-upload').click()" class="text-gray-400 hover:text-white p-2 rounded-full hover:bg-[#333] transition-colors flex-shrink-0" title="ä¸Šå‚³åœ–ç‰‡æˆ–æ–‡ä»¶">
                        <span class="material-symbols-rounded">attach_file</span>
                    </button>
                    <input type="file" id="file-upload" accept="image/*, application/pdf, text/*, .md, .csv" class="hidden" onchange="handleFileUpload(event)">
                    
                    <textarea id="user-input" rows="1" placeholder="è¼¸å…¥è¨Šæ¯... (Shift + Enter æ›è¡Œ)" class="w-full bg-transparent text-gray-100 placeholder-gray-500 outline-none resize-none py-2.5 max-h-48 overflow-y-auto"></textarea>
                    
                    <button id="send-btn" onclick="sendMessage()" class="bg-white text-black p-2 rounded-full hover:bg-gray-200 transition-colors flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed">
                        <span class="material-symbols-rounded">arrow_upward</span>
                    </button>
                </div>
            </div>
            <div class="text-center mt-2 text-xs text-gray-500 font-mono">Powered by anyGem Edge Engine v62.8 (Batch Processing Enabled)</div>
        </div>
    </main>

    <script>
        // âš ï¸ è«‹ç¢ºèªæ­¤ç¶²å€æ˜¯æ‚¨æœ€æ–°çš„ Google Apps Script éƒ¨ç½²ç¶²å€
        const GAS_URL = "https://script.google.com/macros/s/AKfycbwsng4RBCTX67my46U4fv7BhDYT0CIZt95dL7DNCFJTGUJLZFd_854vRGeUsQ1_BjG9/exec"; 
        
        let currentSessionId = generateUUID();
        let currentImageData = null, currentMimeType = null, currentDocumentText = null, currentDocumentName = null;
        let isWaiting = false, currentRenderCode = "";

        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const sessionList = document.getElementById('session-list');

        userInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight < 192 ? this.scrollHeight : 192) + 'px';
        });

        userInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                if (window.innerWidth < 768 || navigator.maxTouchPoints > 0) return;
                e.preventDefault();
                if (!isWaiting) sendMessage();
            }
        });

        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    currentImageData = e.target.result; currentMimeType = file.type;
                    document.getElementById('image-preview').src = currentImageData;
                    document.getElementById('image-preview').classList.remove('hidden');
                    document.getElementById('doc-preview').classList.add('hidden');
                    document.getElementById('upload-preview-container').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            } 
            else if (file.type === 'application/pdf') {
                document.getElementById('user-input').placeholder = "æ­£åœ¨è§£æ PDF...";
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        const pdf = await pdfjsLib.getDocument(new Uint8Array(e.target.result)).promise;
                        let fullText = "";
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const textContent = await (await pdf.getPage(i)).getTextContent();
                            fullText += textContent.items.map(item => item.str).join(' ') + "\n";
                        }
                        setDocumentPayload(file.name, fullText);
                    } catch(err) { alert("PDF è§£æå¤±æ•—"); clearUpload(); }
                };
                reader.readAsArrayBuffer(file);
            }
            else {
                const reader = new FileReader();
                reader.onload = (e) => setDocumentPayload(file.name, e.target.result);
                reader.readAsText(file);
            }
            event.target.value = ''; 
        }

        function setDocumentPayload(name, text) {
            currentDocumentName = name; currentDocumentText = text;
            document.getElementById('doc-filename').innerText = name;
            document.getElementById('doc-preview').classList.remove('hidden');
            document.getElementById('image-preview').classList.add('hidden');
            document.getElementById('upload-preview-container').classList.remove('hidden');
            document.getElementById('user-input').placeholder = "æ–‡ä»¶å·²è§£æï¼Œè¼¸å…¥æ‚¨çš„å•é¡Œ...";
        }

        function clearUpload() {
            currentImageData = null; currentMimeType = null; currentDocumentText = null; currentDocumentName = null;
            document.getElementById('upload-preview-container').classList.add('hidden');
            document.getElementById('user-input').placeholder = "è¼¸å…¥è¨Šæ¯... (Shift + Enter æ›è¡Œ)";
        }

        function openPreview(code) {
            currentRenderCode = code;
            document.getElementById('preview-modal').classList.remove('hidden');
            document.getElementById('preview-modal').classList.add('flex');
            document.body.style.overflow = 'hidden'; 
            document.getElementById('preview-iframe').srcdoc = currentRenderCode;
        }

        function closePreview() {
            document.getElementById('preview-modal').classList.add('hidden');
            document.getElementById('preview-modal').classList.remove('flex');
            document.body.style.overflow = ''; 
            document.getElementById('preview-iframe').srcdoc = ''; 
        }

        function refreshPreview() { document.getElementById('preview-iframe').srcdoc = currentRenderCode; }

        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text && !currentImageData && !currentDocumentText) return;

            let displayUserText = currentDocumentName ? `ğŸ“ [ä¸Šå‚³äº†æ–‡ä»¶: ${currentDocumentName}]\n${text}` : text;
            appendMessage('user', displayUserText, currentImageData);
            
            let payloadText = text || "è«‹ç¸½çµé€™ä»½æ–‡ä»¶æˆ–åœ–ç‰‡";
            if (currentDocumentText) payloadText = `ã€ç³»çµ±æç¤ºï¼šä½¿ç”¨è€…ä¸Šå‚³äº†æ–‡ä»¶ã€Œ${currentDocumentName}ã€ã€‘\n---\n${currentDocumentText}\n---\n\nä½¿ç”¨è€…æŒ‡ä»¤ï¼š${payloadText}`;

            userInput.value = ''; userInput.style.height = 'auto';
            const payloadImage = currentImageData, payloadMime = currentMimeType;
            clearUpload();
            
            isWaiting = true; sendBtn.disabled = true;
            const loadingId = appendLoading(); scrollToBottom();

            try {
                const response = await fetch(GAS_URL, {
                    method: 'POST',
                    body: JSON.stringify({ message: payloadText, session_id: currentSessionId, file_data: payloadImage ? payloadImage.split(',')[1] : null, mime_type: payloadMime })
                });
                const data = await response.json();
                removeLoading(loadingId);
                if (data.status === "error") throw new Error(data.error);
                appendMessage('ai', data.reply, data.image ? `data:${data.mime};base64,${data.image}` : null, data.model);
                loadSessions(); 
            } catch (err) {
                removeLoading(loadingId);
                appendMessage('ai', `âŒ ç³»çµ±ç™¼ç”ŸéŒ¯èª¤\n\`\`\`text\n${err.message}\n\`\`\``);
            } finally {
                isWaiting = false; sendBtn.disabled = false; scrollToBottom();
            }
        }

        function appendMessage(role, text, imageSrc = null, modelInfo = null) {
            const isUser = role === 'user';
            const div = document.createElement('div');
            div.className = `flex gap-4 max-w-4xl mx-auto w-full ${isUser ? 'flex-row-reverse' : ''}`;
            
            const avatar = isUser 
                ? `<div class="w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center flex-shrink-0"><span class="material-symbols-rounded text-sm">person</span></div>`
                : `<div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0"><span class="material-symbols-rounded text-sm text-white">smart_toy</span></div>`;
            
            let contentHtml = '';
            if (imageSrc) contentHtml += `<img src="${imageSrc}" class="max-w-xs md:max-w-md rounded-xl border border-[#444] mb-3 shadow-lg">`;
            if (text) contentHtml += `<div class="prose prose-invert max-w-none text-[15px] leading-relaxed">${isUser ? text.replace(/\n/g, '<br>') : marked.parse(text)}</div>`;
            if (!isUser && modelInfo && modelInfo === 'Agent-Executor') {
                contentHtml += `<div class="mt-3 inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md bg-blue-900/30 text-blue-400 border border-blue-900/50 text-xs font-medium"><span class="material-symbols-rounded text-[14px]">build</span>ç”± Agent Tools è‡ªå‹•åŸ·è¡Œ</div>`;
            }

            div.innerHTML = `${avatar}<div class="${isUser ? 'bg-[#2a2b2f] border border-[#333] px-5 py-3.5 rounded-2xl rounded-tr-sm' : 'pt-1'} max-w-[85%] text-gray-100 overflow-hidden relative">${contentHtml}</div>`;
            chatContainer.appendChild(div);

            if (!isUser) {
                div.querySelectorAll('pre code.language-html').forEach(block => {
                    const pre = block.parentElement; pre.style.position = 'relative'; 
                    const btn = document.createElement('button');
                    btn.innerHTML = '<span class="material-symbols-rounded text-[16px]">play_arrow</span> æ¸²æŸ“é è¦½';
                    btn.className = 'absolute top-2 right-2 bg-blue-600/80 hover:bg-blue-500 text-white text-xs px-2.5 py-1.5 rounded flex items-center gap-1 transition-colors backdrop-blur-md shadow-lg border border-blue-400/30 z-10';
                    btn.onclick = () => openPreview(block.innerText);
                    pre.appendChild(btn);
                });
            }
            scrollToBottom();
        }

        function appendLoading() {
            const id = 'loading-' + Date.now();
            const div = document.createElement('div');
            div.id = id; div.className = `flex gap-4 max-w-4xl mx-auto w-full`;
            div.innerHTML = `<div class="w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0"><span class="material-symbols-rounded text-sm text-white">blur_on</span></div><div class="pt-2"><div class="typing-indicator flex items-center h-6 text-gray-400 text-sm font-medium">ä»£ç†äººæ­£åœ¨æ€è€ƒèˆ‡èª¿ç”¨å·¥å…·<span></span><span></span><span></span></div></div>`;
            chatContainer.appendChild(div); return id;
        }

        function removeLoading(id) { const el = document.getElementById(id); if (el) el.remove(); }
        function scrollToBottom() { chatContainer.scrollTo({ top: chatContainer.scrollHeight, behavior: 'smooth' }); }

        // ==========================================
        // ğŸŒŸ å´é‚Šæ¬„èˆ‡ Session ç®¡ç† (ä¿®å¾©é»é¸ç„¡åæ‡‰å•é¡Œ)
        // ==========================================
        function generateUUID() {
            return 'xxxx-4xxx-yxxx'.replace(/[xy]/g, function(c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8); return v.toString(16);
            });
        }

        function startNewSession() {
            currentSessionId = generateUUID();
            chatContainer.innerHTML = '';
            appendMessage('ai', "æ‚¨å¥½ï¼å·²ç‚ºæ‚¨é–‹å•Ÿå…¨æ–°çš„å°è©±ã€‚");
            if (window.innerWidth < 768) toggleSidebar();
            loadSessions();
        }

        function toggleSidebar() { document.getElementById('sidebar').classList.toggle('-translate-x-full'); }

        async function switchSession(id, title) {
            currentSessionId = id;
            document.getElementById('mobile-title').innerText = title.substring(0, 10);
            chatContainer.innerHTML = '';
            const loadingId = appendLoading();
            if (window.innerWidth < 768) toggleSidebar();
            
            try {
                const res = await fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ mode: 'system', action: 'load_session', session_id: id }) });
                const data = await res.json();
                removeLoading(loadingId);
                
                if (data.logs.length === 0) appendMessage('ai', "é€™æ˜¯ä¸€æ®µæ–°çš„å°è©±ã€‚");
                data.logs.forEach(log => appendMessage(log.role === 'ai' ? 'ai' : 'user', log.text));
                loadSessions();
            } catch (e) {
                removeLoading(loadingId);
                console.error("åˆ‡æ›å¤±æ•—", e);
            }
        }

        async function renameSession(id, oldTitle, event) {
            // event.stopPropagation() å·²åœ¨ addEventListener ä¸­è™•ç†
            const newTitle = prompt("è«‹è¼¸å…¥æ–°çš„å°è©±åç¨±ï¼š", oldTitle);
            if (newTitle && newTitle.trim() !== "" && newTitle !== oldTitle) {
                await fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ mode: 'system', action: 'rename_session', session_id: id, new_title: newTitle.trim() }) });
                loadSessions(); 
            }
        }

        async function deleteSession(id, event) {
            // event.stopPropagation() å·²åœ¨ addEventListener ä¸­è™•ç†
            if (confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†å°è©±ç´€éŒ„å—ï¼Ÿ(åˆªé™¤å¾Œç„¡æ³•å¾©åŸ)")) {
                await fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ mode: 'system', action: 'delete_session', session_id: id }) });
                if (currentSessionId === id) startNewSession(); 
                else loadSessions();
            }
        }

        async function loadSessions() {
            try {
                const res = await fetch(GAS_URL, { method: 'POST', body: JSON.stringify({ mode: 'system', action: 'get_session_list' }) });
                const data = await res.json();
                sessionList.innerHTML = '';
                
                data.sessions.forEach(s => {
                    // 1. å»ºç«‹å®¹å™¨ (ä¸ä½¿ç”¨ innerHTML æ‹¼æ¥ï¼Œé¿å…å¼•è™Ÿå•é¡Œ)
                    const div = document.createElement('div');
                    const isActive = s.id === currentSessionId;
                    div.className = `w-full text-left px-3 py-2.5 rounded-lg text-sm transition-colors flex items-center justify-between group cursor-pointer ${isActive ? 'bg-[#333] text-white' : 'text-gray-400 hover:bg-[#2a2b2f] hover:text-gray-200'}`;
                    
                    // 2. å»ºç«‹ä¸»è¦é»æ“Šå€åŸŸ (åœ–ç¤º + æ–‡å­—)
                    const contentDiv = document.createElement('div');
                    contentDiv.className = "flex items-center gap-2 flex-1 truncate";
                    contentDiv.innerHTML = `<span class="material-symbols-rounded text-[18px]">chat_bubble</span> <span class="flex-1 truncate">${s.title || "æ–°å°è©±"}</span>`;
                    
                    // ğŸš€ é—œéµä¿®å¾©ï¼šä½¿ç”¨ addEventListener ç¶å®šé»æ“Šï¼Œè€Œé onclick å­—ä¸²
                    div.addEventListener('click', () => {
                        switchSession(s.id, s.title || "æ–°å°è©±");
                    });

                    // 3. å»ºç«‹æŒ‰éˆ•å€åŸŸ
                    const btnDiv = document.createElement('div');
                    btnDiv.className = `${isActive ? 'flex' : 'hidden md:group-hover:flex'} items-center gap-1 ml-2`;
                    
                    // ç·¨è¼¯æŒ‰éˆ•
                    const editBtn = document.createElement('button');
                    editBtn.className = "text-gray-400 hover:text-blue-400 p-1 rounded transition-colors";
                    editBtn.title = "é‡æ–°å‘½å";
                    editBtn.innerHTML = '<span class="material-symbols-rounded text-[16px]">edit</span>';
                    editBtn.addEventListener('click', (e) => {
                        e.stopPropagation(); // é˜»æ­¢å†’æ³¡ï¼Œé¿å…è§¸ç™¼åˆ‡æ›å°è©±
                        renameSession(s.id, s.title || "æ–°å°è©±", e);
                    });

                    // åˆªé™¤æŒ‰éˆ•
                    const delBtn = document.createElement('button');
                    delBtn.className = "text-gray-400 hover:text-red-400 p-1 rounded transition-colors";
                    delBtn.title = "åˆªé™¤";
                    delBtn.innerHTML = '<span class="material-symbols-rounded text-[16px]">delete</span>';
                    delBtn.addEventListener('click', (e) => {
                        e.stopPropagation(); // é˜»æ­¢å†’æ³¡
                        deleteSession(s.id, e);
                    });

                    btnDiv.appendChild(editBtn);
                    btnDiv.appendChild(delBtn);

                    div.appendChild(contentDiv);
                    div.appendChild(btnDiv);
                    sessionList.appendChild(div);
                });
            } catch(e) { console.error("ç„¡æ³•è®€å–æ­·å²:", e); }
        }

        window.onload = () => { loadSessions(); };
    </script>
</body>
</html>
